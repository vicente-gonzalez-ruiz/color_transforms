% Emacs, this is -*-latex-*-

\title{3-Channels DCT (Discrete Cosine Transform)}

\maketitle

\tableofcontents

\section{Definition}

The $\text{RGB}$-DCT is a DCT applied to a vector of $3$ elements (in
our case, a $\text{RGB}$ pixel) defined by
\begin{equation}
  \begin{bmatrix}
    \text{DCT}_0 \\
    \text{DCT}_1 \\
    \text{DCT}_2
  \end{bmatrix}
  =
  \begin{bmatrix}
    0.57735027 & 0.70710678 & 0.40824829 \\
    0.57735027 & 0.0 & -0.81649658 \\
    0.57735027 & -0.70710678 & 0.40824829
  \end{bmatrix}
  \begin{bmatrix}
    \text{R} \\
    \text{G} \\
    \text{B}
  \end{bmatrix},
\end{equation}
and the inverse transform by
\begin{equation}
  \begin{bmatrix}
    \text{R} \\
    \text{G} \\
    \text{B}
  \end{bmatrix}
  =
  \begin{bmatrix}
    0.57735027 & 0.57735027 & 0.57735027 \\
    0.70710678 & 0.0 & -0.70710678 \\
    0.40824829 & -0.81649658 & 0.40824829
  \end{bmatrix}
  \begin{bmatrix}
    \text{DCT}_0 \\
    \text{DCT}_1 \\
    \text{DCT}_2
  \end{bmatrix}.
\end{equation}
See the notebook
\href{https://github.com/vicente-gonzalez-ruiz/color_transforms/blob/main/docs/3DCT/notebooks/3DCT.ipynb}{3-Channels
  DCT} to see how to compute the filter's coefficients.

When applied to the $\text{RGB}$ color domain, we will move from this
domain to the color-DCT domain that have also 3 components, that we
will denote by $\text{DCT}_0$, $\text{DCT}_1$ and $\text{DCT}_2$. If
the decorrelation is effective, most of the energy will be
concentrated in $\text{DCT}_0$, which represents the average energy of
the image (luminance).

Notice also that the DCT is orthonormal, and therefore, the matrix of
the forward transform is the transpose of the matrix of the backward
transform~\cite{sayood2017introduction}. This also means that the
contribution of the synthesis filters (which define the inverse
transform) to the reconstructed signal are independent and have
exactly the unity gain.\footnote{To find the gains of any 1D transform
we can compute the energy of the signal generated by the inverse
transform of the impulse discrete 1D signal
\begin{equation}
  \delta_{i}(x) = 
  \left\{
  \begin{array}{ll}
    1 & \text{if $i=x$}\\
    0 & \text{otherwise},
  \end{array}
  \right.
\end{equation}
where the
\href{https://en.wikipedia.org/wiki/Energy_(signal_processing)}{energy
  of a discrete signal} ${\mathbf s}$ is defined as
\begin{equation}
  \langle {\mathbf s}, {\mathbf s} \rangle =  \sum_{i}{{\mathbf s}_i^2}.
\end{equation}
}

\section{Quantization in the 3-DCT domain}
The synthesis filters of orthonormal transforms are orthogonal (their
contributions to the reconstructed signal are independent) and have
exactly the unity gain.\footnote{The quantization error is the same in
all the subbands because all of them have exactly the same gain.}
Therefore, without considering that the entropy coding stage can
performs better for some subbands, the optimal quantization pattern
should be
\begin{equation}
  \Delta_{\text{DCT0}} = \Delta_{\text{DCT1}} = \Delta_{\text{DCT2}}.
\end{equation}
See the notebook
\href{https://github.com/vicente-gonzalez-ruiz/color_transforms/blob/main/docs/3DCT/notebooks/color-DCT_compression.ipynb}{Color-DCT
  image compression}.

Notice that to find the gains (of any 1D transform) we can compute the
energy of the signal generated by the inverse transform of the impulse
discrete 1D signal
\begin{equation}
  \delta_{i}(x) = 
  \left\{
  \begin{array}{ll}
    1 & \text{if $i=x$}\\
    0 & \text{otherwise},
  \end{array}
  \right.
\end{equation}
where the
\href{https://en.wikipedia.org/wiki/Energy_(signal_processing)}{energy
  of a discrete signal} $x$ is defined as
\begin{equation}
  \langle x, x\rangle =  \sum_{i}{x_i^2}.
\end{equation}

If we consider that the RD curve can be affeced by the compresiblity of the subbands, a better solution to find the optimal RD curve is:
\begin{enumerate}
\item Variying the $\Delta$, compute the RD curve for each DCT
  subband.
\item Sort the RD points (considering the three subbands at once), by
  their slope.
\item Apply progressively the combinations of quantization steps
  described by the sorted RD points.
\end{enumerate}
Notice that this algorithm is right because the DCT is orthogonal,
i.e., the contributions of the subbands to the reconstructe signal are
independent. See this \href{https://github.com/Sistemas-Multimedia/Sistemas-Multimedia.github.io/blob/master/study_guide/06-color_transform/color-DCT_compression.ipynb}{notebook}. % Arreglar link

\section{References}

\renewcommand{\addcontentsline}[3]{}% Remove functionality of \addcontentsline
\bibliography{maths,data-compression,signal-processing,DWT,image-compression,image-processing}
